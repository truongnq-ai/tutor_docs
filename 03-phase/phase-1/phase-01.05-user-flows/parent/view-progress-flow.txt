USER FLOW: PARENT – VIEW PROGRESS FLOW
Phase: Phase 1
Actor: Parent
Purpose: Parent xem tiến độ học tập của con ở chế độ read-only

Preconditions (Điều kiện trước)

Parent đã đăng nhập hợp lệ

Parent có role = PARENT

Parent có ParentProfile tồn tại

Parent đã được liên kết hợp lệ với Student (parent-child relation)

Student tồn tại hợp lệ

Student có ChapterProgress dữ liệu

Không tồn tại trial, license, payment, device restriction

Trigger (Hành động kích hoạt)

Parent chọn một Student (con của mình)

Parent yêu cầu xem tiến độ học tập (view progress)

Step-by-step Flow

Step 1
Parent gửi request “view student progress” đến backend.

Step 2
Controller (ChapterProgressController hoặc ProgressReadController):

Xác thực JWT

Xác định actor là PARENT

Chuyển request vào service read-only

Step 3
Service thực hiện guard:

RoleGuard: chỉ PARENT

ParentStudentGuard: parent chỉ được xem Student của mình

Nếu guard FAIL → reject, flow kết thúc.

Step 4
Service truy vấn dữ liệu read-only:

Danh sách Chapter được gán cho Student

ChapterProgress tương ứng:

LOCKED

IN_PROGRESS

COMPLETED

Step 5
Service tổng hợp dữ liệu hiển thị:

Chapter hiện tại đang học (nếu có)

Chapter đã hoàn thành

KHÔNG suy luận thêm tiến độ

Step 6
Controller trả response cho Parent:

Dữ liệu tiến độ ở dạng read-only

Domain Ownership & Authority

Parent KHÔNG sở hữu domain

Parent KHÔNG có authority thay đổi bất kỳ state nào

Mọi dữ liệu parent thấy đều là snapshot read-only

Events

Không emit domain event

Không trigger domain logic

Forbidden Paths (Đường cấm)

Flow này TUYỆT ĐỐI KHÔNG cho phép:

Parent chỉnh sửa chapter_state

Parent trigger Practice

Parent unlock Chapter

Parent thay đổi lifecycle

Parent xem Student không phải con của mình

Postconditions (Trạng thái sau)

Không có domain state nào thay đổi

Hệ thống giữ nguyên trạng thái

Parent View Progress Flow là READ-ONLY tuyệt đối.

Parent chỉ được truy vấn dữ liệu

Không được gọi domain logic mutate

Không được sử dụng ChapterProgressDomainLogic

Không được gọi bất kỳ method nào làm thay đổi state

Dữ liệu Parent nhìn thấy là snapshot trạng thái hiện tại,
không kích hoạt domain event và không có side-effect.

END OF USER FLOW: PARENT – VIEW PROGRESS FLOW